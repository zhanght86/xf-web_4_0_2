<div class="pd-20">
    <form class="form form-horizontal" id="form-robot-setting" action="../../system_manage/setting/upload_head" enctype="multipart/form-data" method="post">
        <input id="setting_id" type="hidden" name="setting_id"/>
        <div class="bk-gray pd-20">
            <div class="bd_d text-c" style="width:100%;height:210px;overflow: auto;">
                <img id="setting_head" src="../../images/u1134.png" style="width:100%;"/>
            </div>
        </div>
        <div class="row cl">
            <div class="pd-10">
                <a href="javascript:;" class="file">
                    <button type="button" class="btn btn-primary radius ">选择图片</button>
                    <input type="file" id="file" name="file" multiple/>
                    <input type="hidden" id="x" name="x" />
                    <input type="hidden" id="y" name="y" />
                    <input type="hidden" id="w" name="w" />
                    <input type="hidden" id="h" name="h" />
                </a>
                <input type="submit" class="btn btn-primary radius" style="position: absolute;left: 150px;" value="确定"/>
            </div>
        </div>
    </form>
</div>
<style>
    .ipt-txt-box .ipt-txt{
        border:1px solid gray;
    }
    .ngdialog.ngdialog-theme-default .ngdialog-content{
        width:500px;
    }
    .file {
        width: 100px;
        height: 38px;
        display: inline-block;
        font-size: 15px;
        overflow: hidden;
        position: relative;
    }
    .file input {
        position: absolute;
        left: 0px;
        top: 0px;
        z-index: 10;
        opacity: 0;
        filter: alpha(opacity=0);
        cursor: pointer;
    }
</style>
<script>

    $("#file").change(function () {
        var objUrl = getObjectURL(this.files[0]);
        if (objUrl) {
            $("#setting_head").attr("src", objUrl);
            cutImage()
        }
    });
    function getObjectURL(file) {
        var url = null;
        if (window.createObjectURL != undefined) {
            url = window.createObjectURL(file);
        } else if (window.URL != undefined) {
            url = window.URL.createObjectURL(file);
        } else if (window.webkitURL != undefined) {
            url = window.webkitURL.createObjectURL(file);
        }
        return url;
    }
    function cutImage(){
        $("#setting_head").Jcrop({
            aspectRatio : 1,
            onChange : showCoords,
            onSelect : showCoords,
            allowSelect: true
        },function(){
            jcrop = this;
        });
        function showCoords(obj) {
            $("#x").val(obj.x);
            $("#y").val(obj.y);
            $("#w").val(obj.w);
            $("#h").val(obj.h);
        }
    }


</script>
