/*! know_front 2017-03-29 */
"use strict";angular.module("know.auth").constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),angular.module("know.auth").factory("AuthService",["$resource","$rootScope","$location","Session","AUTH_EVENTS","localStorageService",function($resource,$rootScope,$location,Session,AUTH_EVENTS,localStorageService){var authService={},loginSuccessFunction=function(fun,result){var data=result.data;Session.create(data.id),localStorageService.set("SessionId",data.id),localStorageService.set("privileges",data.privileges),$rootScope.$broadcast(AUTH_EVENTS.loginSuccess),fun(data)},logoutSuccessFunction=function(fun,result){var data=result.data;Session.destroy(data.id),localStorageService.clearAll(),$rootScope.$broadcast(AUTH_EVENTS.logoutSuccess),fun(data)},authFun=$resource("/back/system/user/:action",{},{login:{method:"POST",params:{action:"login"},isArray:!1,responseType:"json"},checkLoginStatus:{method:"GET",params:{action:"loadUser"},isArray:!1,responseType:"json"},logout:{method:"POST",params:{action:"logout"},isArray:!1,responseType:"json"}});return authService.login=function(credentials,successFunction,failedFunction){authFun.login({loginName:credentials.loginName,loginPwd:credentials.loginPwd,randCheckCode:credentials.randCheckCode,rember:credentials.rememberUser},function(result,b,c){"200"==result.status?(loginSuccessFunction(successFunction,result),$location.path("/index/home")):failedFunction(result.err)},function(a,b,c){$rootScope.$broadcast(AUTH_EVENTS.loginFailed)})},authService.logout=function(successFunction,failedFunction){authFun.logout({},function(result,b,c){"200"==result.status?(logoutSuccessFunction(successFunction,result),$location.path("/login")):failedFunction(result.err)},function(a,b,c){$rootScope.$broadcast(AUTH_EVENTS.loginFailed)})},authService.checkLoginStatus=function(credentials,fun){authFun.checkLoginStatus({},function(result,b,c){"200"==result.status&&loginSuccessFunction(fun,result)},function(a,b,c){Session.destroy(data.id),localStorageService.clearAll(),$rootScope.$broadcast(AUTH_EVENTS.loginFailed)})},authService}]),angular.module("know.auth").factory("AuthInterceptor",function($rootScope,$q,AUTH_EVENTS){return{responseError:function(response){return $rootScope.$broadcast({401:AUTH_EVENTS.notAuthenticated,403:AUTH_EVENTS.notAuthorized,419:AUTH_EVENTS.sessionTimeout,440:AUTH_EVENTS.sessionTimeout}[response.status],response),$q.reject(response)},request:function(config){var ts="?^="+(new Date).getTime();return config.url.indexOf("?")>0?config.url=config.url.replace("?",ts+"&"):config.url=config.url+ts,config}}}),angular.module("know.auth").service("Session",function(){return this.create=function(userId){this.userId=userId},this.destroy=function(){this.userId=null},this}),angular.module("know.home").factory("HomeService",["$resource",function($resource){var homeService={};return homeService.queryknowitem=$resource("pre/homepage/queryknowitem",{},{}),homeService.queryTopic=$resource("pre/Topic/queryTopic",{},{}),homeService.createComment=$resource("pre/Comment/createComment",{},{}),homeService.agree=$resource("back/repository/knowlog/addLogForKnow",{},{}),homeService.collect=$resource("back/repository/knowlog/addLogForKnow",{},{}),homeService.queryMyCollect=$resource("pre/homepage/querymycollect",{},{}),homeService.queryMyTopKnow=$resource("pre/homepage/queryMyTopKnow",{},{}),homeService.queryknowitemrank=$resource("pre/homepage/queryknowitemrank",{},{}),homeService.queryknowitemhot=$resource("pre/homepage/queryknowitemhot",{},{}),homeService.queryUserOrderByPart=$resource("back/system/user/queryUserOrderByPart",{},{}),homeService.queryMyTask=$resource("/back/Workflow/queryUserTask",{},{}),homeService}]),angular.module("know").filter("checkclick",["$location",function($location){return function(item){return item.classtype=$location.absUrl().indexOf(item.url.split(".")[1])>0?"cur_li1":"",item.classtype}}]),angular.module("know.index").factory("IndexService",["$resource",function($resource){return $resource("privilege/:action",{},{queryTopButtons:{method:"GET",params:{action:"getMenu"},isArray:!1}})}]),angular.module("know.knowdoc").factory("KnowDocService",["$resource",function($resource){var knowDocService={};return knowDocService.queryKnowDocList=$resource("/knowledgeDocumentation/queryDocumentation",{},{}),knowDocService.queryDetailByDocId=$resource("/knowledgeDocumentation/selectDocumentationKnowledge",{},{}),knowDocService.deleteKnowDoc=$resource("/knowledgeDocumentation/deleteDocumentation",{},{}),knowDocService}]),angular.module("know.detail").factory("DetailService",["$resource",function($resource){var detailService={};return detailService.getKnowledgeDetail=$resource("pre/KnowledgeDetail/getKnowledgeDetail",{},{}),detailService.queryCommentByKnowItem=$resource("pre/Comment/queryComment",{},{}),detailService.queryRequireByComment=$resource("pre/Comment/queryComment",{},{}),detailService.queryVersionByIdentity=$resource("pre/KnowledgeDetail/queryVersionByIdentity",{},{}),detailService.queryCompareKnowItem=$resource("pre/KnowledgeDetail/queryCompareKnowItem",{},{}),detailService.queryKnowItemsByDocId=$resource("/knowledgeDocumentation/selectDocumentationKnowledge",{},{}),detailService.queryKnowDocByDocId=$resource("/knowledgeDocumentation/selectDocumentationKnowledge",{},{}),detailService.queryLinkKnowItems=$resource("pre/KnowledgeDetail/queryLinkKnowItems",{},{}),detailService.queryKnowItem=$resource("pre/KnowledgeDetail/getKnowledgeDetail",{},{}),detailService.updateKnowItem=$resource("pre/KnowledgeDetail/editKnowItem",{},{}),detailService.deleteComment=$resource("pre/Comment/deleteComment",{},{}),detailService.startWorkflow=$resource("/back/Workflow/startWorkflow",{},{}),detailService.getProcessInstanceId=$resource("/back/Workflow/getProcessInstanceId",{},{}),detailService}]),angular.module("know.search").factory("SearchService",["$resource",function($resource){var searchService={};return searchService.connKnowQueryHistoryCon=$resource("pre/knowsquery/searchhistory",{},{}),searchService.connKnowQueryHotCon=$resource("pre/knowsquery/queryknowitemhot",{},{}),searchService.connKnowQueryAdvancedCon=$resource("pre/knowsquery/seniorsearch",{},{}),searchService.connKnowQueryLeadSearchCon=$resource("pre/knowsquery/leadsearch",{},{}),searchService.connKnowQueryAllLibraryCon=$resource("pre/knowsquery/queryAllLibrary",{},{}),searchService.connKnowQueryKnowOntoCon=$resource("/back/repository/library/queryLibClassify",{},{}),searchService.connKnowSaveSearchSettingCon=$resource("pre/knowsquery/searchset",{},{}),searchService.connQueryNewCon=$resource("pre/knowsquery/queryNewKeyWord",{},{}),searchService.connQueryLibOecTreeCon=$resource("/back/repository/library/queryLibFirstOrderClassify",{},{}),searchService}]),angular.module("know.center").factory("PersonalCenterService",["$resource",function($resource){var personalCenterService={};return personalCenterService.connGetUserInfoCon=$resource("/back/system/user/loadUser",{},{}),personalCenterService.connGetOriginPwdCon=$resource("/back/system/user/queryUserPwd",{},{}),personalCenterService.connTestUploadMeMberCon=$resource("/back/system/user/testUploadMember",{},{}),personalCenterService.connConfirmPwdCon=$resource("/back/system/user/updatePwd",{},{}),personalCenterService.connKnowCheckNoticeCon=$resource("pre/checkNotice/notice/getCheckNotice",{},{}),personalCenterService.connKnowUpdateNoticeCon=$resource("pre/checkNotice/notice/updataNoticeStatus",{},{}),personalCenterService.connSubmitUserInfoCon=$resource("/back/system/user/updateUserInfo",{},{}),personalCenterService.connUpdataNoticeStatusCon=$resource("pre/checkNotice/notice/updataNoticeStatus",{},{}),personalCenterService.connExamNoticeCon=$resource("/back/exam/liveexam/informationtest",{},{}),personalCenterService.connShowExamDetailCon=$resource("/back/exam/liveexam/randomtest",{},{}),personalCenterService.connSaveExamPaperCon=$resource("/back/exam/liveexam/savetesTestinformation",{},{}),personalCenterService.connMycollectCon=$resource("/back/repository/knowlog/queryMyCollect",{},{}),personalCenterService.conndelecollectCon=$resource("/back/repository/knowlog/removeMyCollect",{},{}),personalCenterService.connMyCommentCon=$resource("/back/repository/knowlog/queryMyComment",{},{}),personalCenterService.connCommentMeCon=$resource("/back/repository/knowlog/queryCommentForMe",{},{}),personalCenterService.connMyQuestionCon=$resource("/back/repository/knowlog/queryMyQuestion",{},{}),personalCenterService.connMyAnswerCon=$resource("/back/repository/knowlog/queryMyAnswer",{},{}),personalCenterService.connColumnManagerCon=$resource("/pre/Topic/queryTopic",{},{}),personalCenterService.connAddFirstPageCon=$resource("/pre/Topic/addTopicToPage",{},{}),personalCenterService.connCancelTopicPageCon=$resource("/pre/Topic/cancelTopicPage",{},{}),personalCenterService.connDeleColumnCon=$resource("/pre/Topic/deleteTopic",{},{}),personalCenterService.connCreateColumnCon=$resource("/pre/Topic/createTopic",{},{}),personalCenterService}]),angular.module("know.template").factory("TemplateService",["$resource",function($resource){var templateService={};return templateService.queryTemplate=$resource("/template/queryTemplate",{},{}),templateService.deleteTemplate=$resource("/template/deleteTemplate",{},{}),templateService.queryRules=$resource("/templateRule/queryAllRule",{},{}),templateService.queryTemplateById=$resource("/template/queryTemplate",{},{}),templateService.generateRule=$resource("/templateRule/getJuniorText",{},{}),templateService.getSimilarText=$resource("/templateRule/getSimilarText",{},{}),templateService.optimizeText=$resource("/templateRule/optimizeText",{},{}),templateService.queryTemplateContent=$resource("/template/previewKnowDoc",{},{}),templateService.addWordRule=$resource("/templateRule/addWordRule",{},{}),templateService.checkTemName=$resource("/template/searchByTemplateName",{},{}),templateService.deleteRule=$resource("/templateRule/deleteWordRule",{},{}),templateService.queryRuleById=$resource("/templateRule/queryRuleById",{},{}),templateService}]),angular.module("backModule").controller("backController",["$scope","$location","$interval","$timeout","$state","IndexService","AuthService",function($scope,$location,$interval,$timeout,$state,IndexService,AuthService){$state.go("back.gateway")}]),angular.module("backHomeModule").controller("backHomeController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","HomeService","$sce",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,HomeService,$sce){var self=this;self.initSearch=function(column){$scope.SearchPOJO||($scope.SearchPOJO=$scope.initSearchPOJO()),$scope.paginationConf={currentPage:$scope.SearchPOJO.currentPage,totalItems:0,pageSize:$scope.SearchPOJO.pageSize,pagesLength:6}},self.getMyTask=function(){HomeService.queryMyTask.get({page:$scope.SearchPOJO.currentPage,pageSize:$scope.SearchPOJO.pageSize},function(resource){200==resource.status&&null!=resource.data&&($scope.taskKnowItems=resource.data.taskList,$scope.taskKnowItems.forEach(function(task){var titleHtml=$sce.trustAsHtml(task.knowItemDto.title),contentHtml=$sce.trustAsHtml(task.knowItemDto.content);task.knowItemDto.titleHtml=titleHtml,task.knowItemDto.contentHtml=contentHtml}),$scope.paginationConf.totalItems=resource.data.count)})};var timeout;$scope.$watch("SearchPOJO",function(SearchPOJO){timeout&&$timeout.cancel(timeout),timeout=$timeout(function(){$scope.storeParams(SearchPOJO),self.getMyTask()},350)},!0),self.initSearch()}]),angular.module("knowGatewayModule").controller("adapterController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","AdapterService","TipService","TemplateService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,AdapterService,TipService,TemplateService){var self=this;$scope.targetId="",self.initSearch=function(column){$scope.SearchPOJO||($scope.SearchPOJO=$scope.initSearchPOJO()),$scope.paginationConf={currentPage:$scope.SearchPOJO.currentPage,totalItems:0,pageSize:$scope.SearchPOJO.pageSize,pagesLength:6}},self.queryTemList=function(){},$scope.queryAdaptor=function(){AdapterService.queryAdaptor.get({pageNo:$scope.SearchPOJO.currentPage,pageSize:$scope.SearchPOJO.pageSize,name:$scope.SearchPOJO.name},function(resource){200==resource.status&&($scope.adapters=resource.data.data,$scope.paginationConf.totalItems=resource.data.total)})},$scope.TemSearchPOJO={pageSize:5,currentPage:1},$scope.temPaginationConf={currentPage:$scope.TemSearchPOJO.currentPage,totalItems:0,pageSize:$scope.TemSearchPOJO.pageSize,pagesLength:6,target:$scope.TemSearchPOJO},$scope.getAdType=function(type){return 1==type?"DB":2==type?"Hadoop":3==type?"FTP":4==type?"DOC":void 0},$scope.getAdStatus=function(type){return 1==type?"开":2==type?"关":void 0},$scope.checkAdStatus=function(status){if(2==status)return"on_off_active"},$scope.updateAdStatus=function(id,status){1==status?status=2:2==status&&(status=1),AdapterService.updateAdStatus.save({id:id,status:status},function(re){200==re.status&&200==re.data.status?(TipService.setMessage("更新成功!","success"),$scope.queryAdaptor()):re.data.err&&TipService.setMessage(re.data.err,"error")})},$scope.setAdapter=function(adaptor){var synchronizingTime=adaptor.synchronizingTime/6e4;$scope.AdapterPOJO={name:adaptor.name,type:adaptor.type,synchronizingTime:synchronizingTime,dbtype:adaptor.dbType,url:adaptor.url,userName:adaptor.userName,password:adaptor.password,sql:adaptor.sqlStr,titleCol:adaptor.titleCol,contentCol:adaptor.contentCol,tagCol:adaptor.tagCol,id:adaptor.id}},$scope.addAdaptor=function(){if(!$scope.AdapterPOJO.name||""==$scope.AdapterPOJO.name)return void alert("请输入适配器名称");if($scope.CheckStr($scope.AdapterPOJO.name))return void alert("名称包含非法字符!");if(!$scope.AdapterPOJO.type||""==$scope.AdapterPOJO.type)return void alert("请选择适配器类型");if(1==$scope.AdapterPOJO.type){if(!$scope.AdapterPOJO.dbtype||""==$scope.AdapterPOJO.dbtype)return void alert("请选择数据库类型");if(!$scope.AdapterPOJO.url||""==$scope.AdapterPOJO.url)return void alert("请输入URL");if(!$scope.AdapterPOJO.userName||""==$scope.AdapterPOJO.userName)return void alert("请输入用户名");if(!$scope.AdapterPOJO.password||""==$scope.AdapterPOJO.password)return void alert("请输入密码");if(!$scope.AdapterPOJO.sql||""==$scope.AdapterPOJO.sql)return void alert("请输入SQL语句");if(!$scope.AdapterPOJO.titleCol||""==$scope.AdapterPOJO.titleCol)return void alert("请输入标题列");if(!$scope.AdapterPOJO.contentCol||""==$scope.AdapterPOJO.contentCol)return void alert("请输入内容列");if(!$scope.AdapterPOJO.tagCol||""==$scope.AdapterPOJO.tagCol)return void alert("请输入标记列");if(!$scope.AdapterPOJO.synchronizingTime||isNaN($scope.AdapterPOJO.synchronizingTime)||$scope.AdapterPOJO.synchronizingTime<0)return void alert("请输入正确的时间间隔")}else if(4==$scope.AdapterPOJO.type){if(!$scope.AdapterPOJO.synchronizingTime||isNaN($scope.AdapterPOJO.synchronizingTime)||$scope.AdapterPOJO.synchronizingTime<0)return void alert("请输入正确的时间间隔");if(!$scope.AdapterPOJO.docPath||""==$scope.AdapterPOJO.docPath)return void alert("请输入文档路径")}var synchronizingTime=60*$scope.AdapterPOJO.synchronizingTime*1e3,ob={name:$scope.AdapterPOJO.name,type:$scope.AdapterPOJO.type,synchronizingTime:synchronizingTime,status:2,dbType:$scope.AdapterPOJO.type,url:$scope.AdapterPOJO.url,userName:$scope.AdapterPOJO.userName,password:$scope.AdapterPOJO.password,sqlStr:$scope.AdapterPOJO.sql,titleCol:$scope.AdapterPOJO.titleCol,contentCol:$scope.AdapterPOJO.contentCol,tagCol:$scope.AdapterPOJO.tagCol,remoteStatus:100,docPath:$scope.AdapterPOJO.docPath,temId:$scope.temId,id:$scope.AdapterPOJO.id,libId:$scope.AdapterPOJO.libId};ob.id?AdapterService.updateAdStatus.save(ob,function(resource){200==resource.status&&200==resource.data.status?($scope.reset(),$scope.queryAdaptor(),$(".popup_wrap").hide(),TipService.setMessage("更新成功!","success")):resource.data.err&&alert(resource.data.err)}):AdapterService.addAdaptor.save(ob,function(resource){200==resource.status&&200==resource.data.status?($scope.reset(),$scope.queryAdaptor(),$(".popup_wrap").hide(),TipService.setMessage("创建成功!","success")):resource.data.err&&alert(resource.data.err)})},$scope.reset=function(){$scope.AdapterPOJO={},$scope.targetId=""},$scope.convertSS2mm=function(time){return time/6e4},$scope.deleteAdapter=function(id){AdapterService.deleteAdaptor.get({id:id},function(re){200==re.status&&200==re.data.status?(TipService.setMessage("删除成功!","success"),$scope.queryAdaptor()):re.data.err&&TipService.setMessage(re.data.err,"error")})};var timeout;$scope.$watch("SearchPOJO",function(SearchPOJO){timeout&&$timeout.cancel(timeout),timeout=$timeout(function(){$scope.storeParams(SearchPOJO),$scope.queryAdaptor()},350)},!0),self.initSearch()}]),angular.module("knowGatewayModule").controller("analyseTaskController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","KnowDocService","SearchService","TemplateService","TipService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,KnowDocService,SearchService,TemplateService,TipService){var self=this;$scope.processMethod=!0,self.initSearch=function(column){$scope.SearchPOJO||($scope.SearchPOJO=$scope.initSearchPOJO()),$scope.paginationConf={currentPage:$scope.SearchPOJO.currentPage,totalItems:0,pageSize:$scope.SearchPOJO.pageSize,pagesLength:6}},$scope.TemSearchPOJO={pageSize:5,currentPage:1},$scope.temPaginationConf={currentPage:$scope.TemSearchPOJO.currentPage,totalItems:0,pageSize:$scope.TemSearchPOJO.pageSize,pagesLength:6,target:$scope.TemSearchPOJO},$scope.queryTemplate=function(){TemplateService.queryTemplate.save({index:($scope.TemSearchPOJO.currentPage-1)*$scope.TemSearchPOJO.pageSize,pageSize:$scope.TemSearchPOJO.pageSize,requestId:"string"},function(resource){200==resource.status&&($scope.templates=resource.data.objs,$scope.temPaginationConf.totalItems=resource.data.total)})},$scope.getTaskStatus=function(taskStatus){return 0==taskStatus?"未开始":1==taskStatus?"解析中":2==taskStatus?"解析成功":3==taskStatus?"解析失败":void 0},$scope.getAnalyseType=function(analyseType){return 0==analyseType?"全文解析":1==analyseType?"目录解析":2==analyseType?"模板解析":3==analyseType?"插件解析":void 0},$scope.resetUploadPOJO=function(){$scope.libraryIds&&$scope.libraryIds.length>0&&($scope.uploadLibraryId=$scope.libraryIds[0].id),$scope.targetId=""},$scope.queryKnowDocList=function(){KnowDocService.queryKnowDocList.save({index:($scope.SearchPOJO.currentPage-1)*$scope.SearchPOJO.pageSize,pageSize:$scope.SearchPOJO.pageSize,documentationName:$scope.SearchPOJO.docName,documentationCreateTime:$scope.SearchPOJO.startTime,documentationModifyTime:$scope.SearchPOJO.endTime,documentationCreater:$scope.SearchPOJO.userName,requestId:"string"},function(resource){200==resource.status&&($scope.knowDocs=resource.data.objs,$scope.paginationConf.totalItems=resource.data.total)})},$scope.resetKnowDocSearchPOJO=function(){$scope.SearchPOJO.currentPage=1,$scope.SearchPOJO.docName="",$scope.SearchPOJO.startTime="",$scope.SearchPOJO.endTime="",$scope.SearchPOJO.libraryId="",$scope.SearchPOJO.isRepeated="",$scope.SearchPOJO.userName=""},$scope.deleteKnowDoc=function(knowDocId){KnowDocService.deleteKnowDoc.save({documentationId:knowDocId},function(resource){200==resource.status&&(TipService.setMessage("删除成功!","success"),$scope.queryKnowDocList())})};var timeout;$scope.$watch("SearchPOJO",function(SearchPOJO){timeout&&$timeout.cancel(timeout),timeout=$timeout(function(){$scope.storeParams(SearchPOJO),$scope.queryKnowDocList()},350)},!0),self.initSearch();var timeout3;$scope.$watch("TemSearchPOJO",function(SearchPOJO){timeout3&&$timeout.cancel(timeout3),timeout=$timeout(function(){$scope.queryTemplate()},350)},!0)}]),angular.module("knowGatewayModule").controller("createTemController",["$scope","$location","$stateParams","$interval","$timeout","ngDialog","TemplateService","localStorageService","$state","TipService",function($scope,$location,$stateParams,$interval,$timeout,ngDialog,TemplateService,localStorageService,$state,TipService){$scope.temName="",$scope.temType="WORD",$scope.temNameChecked=!1,$scope.fileName="未选择文件",1!=$stateParams.isGo&&localStorageService.get($state.current.name)?$scope.temId=localStorageService.get($state.current.name):$stateParams.temId&&($scope.storeParams($stateParams.temId),$scope.temId=$stateParams.temId),$scope.queryTemplateById=function(){TemplateService.queryTemplateById.save({index:0,pageSize:1,templateId:$scope.temId},function(resource){if(200==resource.status&&resource.data){$scope.temName=resource.data.objs[0].templateName;var filePath=resource.data.objs[0].templateUrl,filename=filePath.substring(filePath.lastIndexOf("//")+2,filePath.length);$scope.fileName=filename}})},$scope.queryRules=function(){TemplateService.queryRules.save({templateId:$scope.temId},function(resource){200==resource.status&&resource.data&&($scope.rules=resource.data.objs)})},$scope.addRule=function(){$scope.rules?($scope.rules.push({sort:$scope.rules.length+1}),$(".proce_result ").trigger("click")):alert("请先上传模板或选定模板")},$scope.deleteRule=function(ruleId){ruleId&&TemplateService.deleteRule.save({ruleId:ruleId},function(resource){200==resource.status&&resource.data?(TipService.setMessage("删除成功!","success"),$scope.queryTemplateById()):TipService.setMessage("删除失败!","err")})},$scope.resetRule=function(index){var rule=$scope.rules[index];rule&&!rule.id&&$scope.rules.splice(index,1)},$scope.backT=function(){history.back()};var timeout;$scope.$watch("temId",function(temId){temId&&(timeout&&$timeout.cancel(timeout),timeout=$timeout(function(){$scope.queryTemplateById(),$scope.queryRules()},350))},!0);var timeout2;$scope.$watch("temName",function(temName){temName&&""!=temName&&(timeout2&&$timeout.cancel(timeout2),timeout2=$timeout(function(){TemplateService.checkTemName.save({templateName:$scope.temName},function(resource){200==resource.status&&0==resource.data.objs.length?$scope.temNameChecked=!0:$scope.temNameChecked=!1})},350))},!0)}]),angular.module("knowGatewayModule").controller("docSelectController",["$scope","$location","$stateParams","$interval","$timeout","ngDialog","TemplateService","localStorageService","$state","$sce",function($scope,$location,$stateParams,$interval,$timeout,ngDialog,TemplateService,localStorageService,$state,$sce){$scope.checkedRule={},$scope.temId=$stateParams.temId,$scope.level=$stateParams.level,$scope.roleId=$stateParams.roleId,$scope.showExtract=!1,$scope.queryRole=function(){TemplateService.queryRuleById.save({ruleId:$scope.roleId},function(re){if(200==re.status){var data=re.data;$scope.titleText=data.inputText,$scope.extractRegTxt=data.extractReg,$scope.checkModel=data.model,$scope.returnRole=data,$scope.generateRule()}})},$scope.queryTemplateContent=function(){TemplateService.queryTemplateContent.save({index:0,pageSize:1,templateId:$scope.temId},function(re){if(200==re.status&&$scope.notEmpty(re.data)&&re.data.length>0){var queryTemContent=$sce.trustAsHtml(re.data);$scope.queryTemContent=queryTemContent}})},$scope.generateRule=function(){return $scope.titleText&&""!=$scope.titleText?void TemplateService.generateRule.save({templateId:$scope.temId,level:$scope.level,text:$scope.titleText},function(re){if(200==re.status&&re.data.objs.length>0){$scope.rules=re.data.objs;for(var i=0;i<$scope.rules.length;i++){var rule=$scope.rules[i];$scope.returnRole&&$scope.returnRole.firstLineIndent==rule.firstLineIndent&&$scope.returnRole.fontAlignment==rule.fontAlignment&&$scope.returnRole.selectText==rule.lineWord&&($scope.checkedRuleIndex=i)}$scope.getSimilarText()}}):void alert("请填写匹配标题")},$scope.getSimilarText=function(){return void 0!=$scope.rules&&void 0!=$scope.checkedRuleIndex&&void 0!=$scope.rules[$scope.checkedRuleIndex]?$scope.checkedRule=$scope.rules[$scope.checkedRuleIndex]:$scope.checkedRule=void 0,$scope.checkedRule&&""!=$scope.checkedRule?void TemplateService.getSimilarText.save({lineWord:$scope.checkedRule.lineWord,firstLineIndent:$scope.checkedRule.firstLineIndent,fontAlignment:$scope.checkedRule.fontAlignment,level:$scope.checkedRule.level,model:$scope.checkedRule.model,numFmt:$scope.checkedRule.numFmt,numLevelText:$scope.checkedRule.numLevelText,style:$scope.checkedRule.style,templateId:$scope.checkedRule.templateId},function(re){200==re.status&&(re.data.objs.length>0?($scope.strs=re.data.objs,null!=$scope.extractRegTxt&&""!=$scope.extractRegTxt&&$scope.optimizeText()):alert("未能抽取到匹配内容"))}):void alert("请选择匹配标题")},$scope.optimizeText=function(){return!$scope.strs||$scope.strs.length<=0?void alert("没有匹配的标题"):$scope.extractRegTxt&&""!=$scope.extractRegTxt?void TemplateService.optimizeText.save({regexRule:$scope.extractRegTxt,texts:$scope.strs},function(re){200==re.status&&(re.data.objs.length>0?$scope.extractStrs=re.data:alert("未能匹配到相应正则结果"))}):void alert("请输入正则表达式")},$scope.addWordRule=function(){return void 0!=$scope.rules&&void 0!=$scope.checkedRuleIndex&&void 0!=$scope.rules[$scope.checkedRuleIndex]?$scope.checkedRule=$scope.rules[$scope.checkedRuleIndex]:$scope.checkedRule=void 0,$scope.checkedRule?void TemplateService.addWordRule.save({lineWord:$scope.checkedRule.lineWord,firstLineIndent:$scope.checkedRule.firstLineIndent,fontAlignment:$scope.checkedRule.fontAlignment,level:$scope.checkedRule.level,model:$scope.checkModel,numFmt:$scope.checkedRule.numFmt,numLevelText:$scope.checkedRule.numLevelText,style:$scope.checkedRule.style,templateId:$scope.checkedRule.templateId,extractReg:$scope.extractRegTxt,inputText:$scope.titleText,selectText:$scope.checkedRule.lineWord,requestId:"String"},function(re){200==re.status&&history.back()}):void alert("请选择要保存的规则")},$scope.checkRule=function(rule){return!(!$scope.returnRole||$scope.returnRole.firstLineIndent!=rule.firstLineIndent||$scope.returnRole.fontAlignment!=rule.fontAlignment||$scope.returnRole.selectText!=rule.lineWord)},$scope.queryTemplateContent(),null!=$scope.roleId&&""!=$scope.roleId&&$scope.queryRole()}]),angular.module("knowGatewayModule").controller("temController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","TemplateService","TipService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,TemplateService,TipService){var self=this;self.initSearch=function(column){$scope.SearchPOJO||($scope.SearchPOJO=$scope.initSearchPOJO()),$scope.paginationConf={currentPage:$scope.SearchPOJO.currentPage,totalItems:0,pageSize:$scope.SearchPOJO.pageSize,pagesLength:6}},$scope.queryTemplate=function(){TemplateService.queryTemplate.save({index:($scope.SearchPOJO.currentPage-1)*$scope.SearchPOJO.pageSize,pageSize:$scope.SearchPOJO.pageSize,requestId:"string",templateName:$scope.SearchPOJO.name},function(resource){200==resource.status&&($scope.templates=resource.data.objs,$scope.paginationConf.totalItems=resource.data.total)})},$scope.deleteTemplate=function(temId){TemplateService.deleteTemplate.save({templateId:temId},function(resource){200==resource.status&&(TipService.setMessage("删除成功!","success"),$scope.queryTemplate())})},$scope.temType=function(typeNum){if(1==typeNum)return"WORD"};var timeout;$scope.$watch("SearchPOJO",function(SearchPOJO){timeout&&$timeout.cancel(timeout),timeout=$timeout(function(){$scope.storeParams(SearchPOJO),$scope.queryTemplate()},350)},!0),self.initSearch()}]),knowledge_static_web.directive("gatewayMenu",function(){return{restrict:"AE",scope:{},link:function($scope,elem,attrs){elem.click(function(){$(".popup_span").show(),"file"==attrs.gatewayMenu?$(".import_from_txt").css("visibility","visible"):"single"==attrs.gatewayMenu?$(".add_single_popup").css("visibility","visible"):"adapter"==attrs.gatewayMenu&&$(".jr_Agent").show()})}}}),knowledge_static_web.directive("plupload",["$timeout",function($timeout){return{restrict:"A",link:function($scope,iElm,iAttrs,controller){var uploader=new plupload.Uploader({runtimes:"html4,html5,flash,silverlight",browse_button:"pickfiles",url:"noturl",multi_selection:!0,filters:{max_file_size:"10mb",mime_types:[{title:"Know File",extensions:"doc,docx,txt,pdf,xls,xlsx,html,ppt,pptx"}]},flash_swf_url:"/plupload/Moxie.swf",silverlight_xap_url:"/plupload/Moxie.xap",init:{PostInit:function(){$("#uploadfiles").click(function(){var params={templateId:$scope.targetId,requestId:"String",userId:"testuser"};return 1!=$scope.processMethod||$scope.targetId&&null!=$scope.targetId?(uploader.setOption("multipart_params",params),uploader.setOption("url","/knowledgeDocumentation/createDocumentation"),uploader.start(),!1):void alert("请选择加工模板")}),$("#reset").click(function(){if(uploader.files.length>0)for(var i=uploader.files.length;i>0;i--)uploader.removeFile(uploader.files[i-1]);$scope.$apply($scope.resetUploadPOJO())})},FilesAdded:function(up,files){plupload.each(files,function(file){$("#file_container").append('<div class="file_con" id="'+file.id+'"style="overflow:hidden"><span  class="name">'+file.name+'</span><b class="progress">0%</b><span class="size"> ('+plupload.formatSize(file.size)+") </span></div>")})},FilesRemoved:function(up,files){plupload.each(files,function(file){up.files.length<=0&&$("#file_container").html("")})},UploadProgress:function(up,file){$("#"+file.id).find("b").html("<span>"+file.percent+"%</span>")},Error:function(up,err){},UploadComplete:function(uploader,files){},FileUploaded:function(uploader,files,res){$scope.queryKnowDocList(),$("#file_container").html(""),$scope.resetUploadPOJO(),$(".template_inpt").val(""),200==res.status&&($(".popup_wrap").hide(),$(".popup_span").hide(),$(".import_from_txt").css("visibility","hidden"),$(".add_single_popup").css("visibility","hidden"))}}});uploader.init()}}}]),knowledge_static_web.directive("tempPlupload",["$timeout",function($timeout){return{restrict:"A",link:function($scope,iElm,iAttrs,controller){var uploader=new plupload.Uploader({runtimes:"html4,html5,flash,silverlight",browse_button:"tempickfile",url:"/template/createTemplate",max_file_count:1,multi_selection:!1,filters:{max_file_size:"10mb",mime_types:[{title:"Know File",extensions:"doc,docx"}]},flash_swf_url:"/plupload/Moxie.swf",silverlight_xap_url:"/plupload/Moxie.xap",init:{PostInit:function(){$("#temupload").click(function(){return null!=$scope.temName&&""!=$scope.temName&&$scope.temName?$scope.temName.length>50?void alert("模板名称不能大于50字"):$scope.temNameChecked?uploader.files.length<=0?void alert("请选择上传文件"):(uploader.setOption("multipart_params",{type:$scope.temType,templateName:$scope.temName,requestId:"String",userId:"testUser"}),uploader.start(),!1):void alert("模板名校验失败"):void alert("请输入模板名称")}),$("#temreset").click(function(){if(uploader.files.length>0)for(var i=uploader.files.length;i>0;i--)uploader.removeFile(uploader.files[i-1])})},FilesAdded:function(up,files){plupload.each(files,function(file){$("#temcontainer").html('<div class="file_con" id="'+file.id+'"style="overflow:hidden"><span  class="name">'+file.name+'</span><b class="progress">0%</b><span class="size"> </span></div>'),up.files.length<=1||up.removeFile(file)})},FilesRemoved:function(up,files){plupload.each(files,function(file){up.files.length<=0&&$("#temcontainer").html("未选择文件")})},UploadProgress:function(up,file){$("#"+file.id).find("b").html("<span>"+file.percent+"%</span>")},Error:function(up,err){},UploadComplete:function(uploader,files){},FileUploaded:function(uploader,files,res){if(200==res.status){var response=JSON.parse(res.response.replace(/<.*?>/gi,""));200==response.status?(alert("模板文件上传成功，请添加规则"),$scope.$apply(function(){$scope.temId=response.data.templateId,$scope.storeParams($scope.temId)})):alert("模板文件上传失败")}}}});uploader.init()}}}]),knowledge_static_web.directive("advanceMenu",function(){return{restrict:"AE",scope:{},link:function($scope,elem,attrs){elem.click(function(e){var e=e||window.event;e.stopPropagation(),$(".advan_search_div").is(":hidden")?($(".advan_search_div").show(),$(".advan_search").addClass("on")):($(".advan_search_div").hide(),$(".advan_search").removeClass("on"));
})}}}),knowledge_static_web.directive("advansearchdiv",function(){return{restrict:"AE",scope:{},link:function($scope,elem,attrs){elem.click(function(e){var e=e||window.event;$(this).show(),e.stopPropagation()}),$(document).click(function(){elem.hide()})}}}),knowledge_static_web.directive("processMethodMenu",function(){return{restrict:"AE",link:function($scope,elem,attrs){attrs.processMethodMenu;elem.click(function(){0==$scope.processMethod?($("#modelSelect").show(),$("#modelAdd").show(),$scope.queryTemplate()):($("#modelSelect").hide(),$("#modelAdd").hide())})}}}),knowledge_static_web.directive("templateInput",function(){return{restrict:"AE",link:function($scope,elem,attrs){elem.click(function(e){var ev=e||window.event;$(".template_con").show(),ev.stopPropagation()}),$(document).click(function(){$(".template_con").hide()})}}}),knowledge_static_web.directive("templateCon",function(){return{restrict:"AE",link:function($scope,elem,attrs){elem.click(function(e){var ev=e||window.event;ev.stopPropagation()}),$scope.$on("onRenderFinish",function(event){$(".template_con tbody tr").click(function(){var value=$(this).find("td").eq(1).html(),id=$(this).find("td").eq(3).html();$(".template_inpt").val(value),$scope.$parent.targetId=$scope.targetId=id,$(this).parents(".template_con").hide()})})}}}),knowledge_static_web.directive("mouldShowMenu",function(){return{restrict:"AE",scope:{},link:function($scope,elem,attrs){elem.change(function(){"模板加工"==$(this).val()&&$(this).next().show()})}}}),knowledge_static_web.directive("closeMenu",function(){return{restrict:"AE",scope:{},link:function($scope,elem,attrs){elem.click(function(){$(".popup_wrap").hide(),$(".popup_span").hide(),$(".import_from_txt").css("visibility","hidden"),$(".add_single_popup").css("visibility","hidden")})}}}),knowledge_static_web.directive("onOff",function(){return{restrict:"AE",scope:{updateAdStatus:"&upfunction"},link:function($scope,elem,attrs){elem.click(function(){$(this).hasClass("on_off_active")?$(this).removeClass("on_off_active"):$(this).addClass("on_off_active"),$scope.updateAdStatus()})}}}),knowledge_static_web.directive("dropDownMenuByZtree",function(){return{restrict:"AE",scope:{},link:function($scope,elem,attrs){function beforeClick(treeId,treeNode){var zTree=$.fn.zTree.getZTreeObj(treeDemo);return zTree.checkNode(treeNode,!treeNode.checked,null,!0),!1}function onCheck(e,treeId,treeNode){function getParentNodes(node,allNode){if(null!=node){allNode+="->"+node.name;var curNode=node.getParentNode();getParentNodes(curNode,allNode)}else curLocation=allNode}var zTree=$.fn.zTree.getZTreeObj(treeDemo),nodes=zTree.getCheckedNodes(!0),selectLocation="";if(null!=nodes&&void 0!=nodes&&nodes.length>0)for(var m=0;m<nodes.length;m++){var curLocation="",allNode=nodes[m].name,node=nodes[m].getParentNode();getParentNodes(node,allNode);for(var location="",nodeArrs=curLocation.split("->"),i=nodeArrs.length-1;i>=0;i--)location+=nodeArrs[i]+"->";location=location.substring(0,location.lastIndexOf("->")),selectLocation+=location+","}else selectLocation="",$scope.$parent.classifyId="";selectLocation.length>0&&(selectLocation=selectLocation.substring(0,selectLocation.length-1)),""!=$.trim(selectLocation)&&null!=selectLocation&&($scope.$parent.classifyId=selectLocation);for(var v="",i=0,l=nodes.length;i<l;i++)v+=nodes[i].name+",";v.length>0&&(v=v.substring(0,v.length-1));var cityObj=$("#"+citySel);cityObj.attr("value",v)}function hideMenu(){$("#"+menuContent).fadeOut("fast"),$("body").unbind("mousedown",onBodyDown)}function onBodyDown(event){"menuBtn"==event.target.id||event.target.id==citySel||event.target.id==menuContent||$(event.target).parents("#"+menuContent).length>0||hideMenu()}var setting={check:{enable:!0,chkboxType:{Y:"",N:""}},view:{dblClickExpand:!1},data:{simpleData:{enable:!0}},callback:{beforeClick:beforeClick,onCheck:onCheck}},split=attrs.dropDownMenuByZtree,arr=split.split(","),citySel=arr[0],menuContent=arr[1],treeDemo=arr[2];elem.click(function(){$("#"+menuContent).css({left:"130px",top:"143px"}).slideDown("fast"),$("body").bind("mousedown",onBodyDown)}),$scope.$emit("menu",attrs.value),$scope.$on("menuData",function(event,data){$.fn.zTree.init($("#"+treeDemo),setting,data)})}}}),knowledge_static_web.controller("ApplicationController",["$scope","$location","$anchorScroll","AuthService","TipService","AUTH_EVENTS","$state","localStorageService","$stateParams","$sce","$window","HomeService","PersonalCenterService","KnowDocService",function($scope,$location,$anchorScroll,AuthService,TipService,AUTH_EVENTS,$state,localStorageService,$stateParams,$sce,$window,HomeService,PersonalCenterService,KnowDocService){$scope.currentUser=null,$scope.isAuthorized=AuthService.isAuthorized,$scope.currentPage=1,$scope.pageSize=10,$scope.tipService=TipService,$scope.backTage=!($location.url().indexOf("index")>0),$scope.setCurrentUser=function(data){$scope.currentUser={id:data.id,userName:data.name,realName:data.realName,sex:data.sex,email:data.email,protarit:data.protarit,phone:data.phone,identity:data.identity,birthday:data.birthday,status:data.status,role:data.role,lastLoginTime:data.lastLoginTime,privileges:data.privileges}},$scope.getCurrentUserPrivileges=function(){return $scope.currentUser.privileges?$scope.currentUser.privileges:localStorageService.get("privileges")?localStorageService.get("privileges"):null},$scope.getCurrentUserId=function(){return $scope.currentUser&&$scope.currentUser.id?$scope.currentUser.id:localStorageService.get("SessionId")?localStorageService.get("SessionId"):null},$scope.goto=function(id){$location.hash(id),$anchorScroll()},$scope.initSearchPOJO=function(){return $stateParams.isGo||!localStorageService.get($state.current.name)?{currentPage:$scope.currentPage,pageSize:$scope.pageSize}:localStorageService.get($state.current.name)},$scope.notEmpty=function(param){return null!=param&&void 0!=param&&""!=$.trim(param)},$scope.sceConvertHtml=function(objectList){return $scope.notEmpty(objectList)&&objectList.length>0&&objectList.forEach(function(item){var title=$sce.trustAsHtml(item.title),content=$sce.trustAsHtml(item.content);item.titleHtml=title,item.contentHtml=content}),objectList},$scope.CheckStr=function(str){var myReg=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}\"%'+-/_【】‘；：”“'。，、？]");return!!myReg.test(str)},$scope.addComment=function(scope,knowItemId,index,userId,successFun){var comment=scope.comments[index],flag=!1;return null==comment&&alert("评论不能为空！"),comment.length>500?void alert("评论不能超过500个字！"):(null!=comment&&(flag=!0),void(flag&&HomeService.createComment.save({commType:0,content:comment,knowItemId:knowItemId,targetId:userId},function(){scope.comments[index]="",successFun()})))},$scope.format=function(time,format){var t=new Date(time),tf=function(i){return(i<10?"0":"")+i};return format.replace(/yyyy|MM|dd|HH|mm|ss/g,function(a){switch(a){case"yyyy":return tf(t.getFullYear());case"MM":return tf(t.getMonth()+1);case"mm":return tf(t.getMinutes());case"dd":return tf(t.getDate());case"HH":return tf(t.getHours());case"ss":return tf(t.getSeconds())}})},$scope.changeURLArg=function(url,arg,arg_val){var pattern=arg+"=([^&]*)",replaceText=arg+"="+arg_val;if(url.match(pattern)){var tmp="/("+arg+"=)([^&]*)/gi";return tmp=url.replace(eval(tmp),replaceText)}return url.match("[?]")?url+"&"+replaceText:url+"?"+replaceText},$scope.storeParams=function(value){var key=$state.current.name;localStorageService.set(key,value)},$scope.goHistory=function(){$window.history.back()},$scope.logout=function(){AuthService.logout(function(data){},function(errMsg){$scope.errMsg=errMsg})},$scope.initKnowCheckNoticeView=function(){PersonalCenterService.connKnowCheckNoticeCon.get({flag:1},function(resource){var resultData=resource.data;$scope.resultCheckNoticeList=resultData.data,$scope.resultCheckNoticeTotal=resultData.total})},$scope.initNoCheckTaskView=function(){HomeService.queryMyTask.get({page:1,pageSize:10},function(resource){200==resource.status&&($scope.taskCount=resource.data.count)})},$scope.initAnalyseTaskCount=function(){KnowDocService.queryAnalyseTaskCount.get({getCount:!0,taskStatus:0},function(resource){200==resource.status&&($scope.analyseTaskCount=resource.data.data.total)})},$scope.$on(AUTH_EVENTS.notAuthorized,function(event,data){null!=data.fromState.name&&""!=data.fromState.name&&$state.go($window.location.reload())}),$scope.$on(AUTH_EVENTS.logoutSuccess,function(event,data){$scope.currentUser=null}),$scope.$on(AUTH_EVENTS.loginSuccess,function(event,data){$scope.initKnowCheckNoticeView(),$scope.initNoCheckTaskView(),$scope.initAnalyseTaskCount()})}]),angular.module("adminModule").controller("adminContentController",["$scope","$state","$timeout","$stateParams","ngDialog",function($scope,$state,$timeout,$stateParams,ngDialog){function myApplication(){var sel=$scope;httpRequestPost("/api/application/application/listApplicationByUserId",{userId:getCookie("userId")},function(data){sel.vm.myApplication=data.data,$scope.$apply()},function(err){})}function selectLicence(){httpRequestPost("/api/application/scene/listAllScene",{},function(data){return $scope.vm.selectLicence=data.data,$scope.$apply(),data.data},function(err){})}function addApplicationWindow(){ngDialog.openConfirm({template:"/know_index/admin/addAdmin.html",scope:$scope,closeByDocument:!1,closeByEscape:!0,showClose:!0,backdrop:"static",preCloseCallback:function(e){1===e&&addApplication()}})}function addApplication(){httpRequestPost("/api/application/application/addApplication",{userId:getCookie("userId"),applicationName:$scope.vm.newApplicationName,sceneId:$scope.vm.newScene,applicationLisence:$scope.vm.newLicence,applicationDescription:$scope.vm.newDescribe},function(data){},function(err){})}setCookie("userName","mf"),getCookie("userName"),$scope.vm={userName:getCookie("userName"),userPermission:$stateParams.userPermission,addApplicationWindow:addApplicationWindow,myApplication:"",selectLicence:"",newApplicationName:"",newScene:"",newLicence:"",newDescribe:""},myApplication(),selectLicence()}]),angular.module("adminModule").controller("adminController",["$scope","$state","$stateParams",function($scope,$state,$stateParams){$state.go("admin.manage",{userPermission:$stateParams.userPermission})}]),knowledge_static_web.directive("knowledgeitem",["KnowledgePortalService","ngDialog",function(KnowledgePortalService){return{templateUrl:"know_index/base/knowledge_item/directives/knowledge_item.html",restrict:"E",replace:!0,link:function(scope,element){scope.focusKnowItem=function(knowItem){KnowledgePortalService.focus(knowItem)},scope.toShareKnowItem=function(selectedKnowItem){KnowledgePortalService.toShareKnowItem(selectedKnowItem)},scope.showCommentContainer=function(knowItemId){$("#commentContent"+knowItemId).is(":hidden")?($("#commentContent"+knowItemId).attr("class","show"),scope.comment=""):$("#commentContent"+knowItemId).attr("class","hide")},scope.submitComment=function(knowItemId){var comment=$("#commentContent"+knowItemId).find("textarea").val();null!=comment&&""!=$.trim(comment)&&KnowledgePortalService.replyKnowItem(knowItemId,comment)}}}}]),angular.module("pagination",[]).directive("pagination",[function(){return{restrict:"EA",templateUrl:"know_index/base/page/template.html",replace:!0,scope:{conf:"="},link:function(scope,element,attrs){function getPagination(newValve,oldValue){if(scope.conf.currentPage=parseInt(scope.conf.currentPage)?parseInt(scope.conf.currentPage):1,scope.conf.totalItems=parseInt(scope.conf.totalItems)?parseInt(scope.conf.totalItems):0,scope.conf.pageSize=parseInt(scope.conf.pageSize)?parseInt(scope.conf.pageSize):15,scope.conf.numberOfPages=Math.ceil(scope.conf.totalItems/scope.conf.pageSize),scope.conf.currentPage<1&&(scope.conf.currentPage=1),scope.conf.numberOfPages>0&&scope.conf.currentPage>scope.conf.numberOfPages&&(scope.conf.currentPage=scope.conf.numberOfPages),scope.jumpPageNum=scope.conf.currentPage,scope.pageList=[],scope.conf.numberOfPages<=scope.conf.pagesLength)for(var i=1;i<=scope.conf.numberOfPages;i++)scope.pageList.push(i);else{var offset=scope.conf.pagesLength%2==0?scope.conf.pagesLength/2:(scope.conf.pagesLength-1)/2;if(scope.conf.currentPage<=offset){for(var i=1;i<=offset+1;i++)scope.pageList.push(i);scope.pageList.push("..."),scope.pageList.push(scope.conf.numberOfPages)}else if(scope.conf.currentPage>scope.conf.numberOfPages-offset){for(scope.pageList.push(1),scope.pageList.push("..."),i=offset;i>=1;i--)scope.pageList.push(scope.conf.numberOfPages-i);scope.pageList.push(scope.conf.numberOfPages)}else{scope.pageList.push(1),scope.pageList.push("...");for(var i=Math.ceil(offset/2)-1;i>=1;i--)scope.pageList.push(scope.conf.currentPage-i);scope.pageList.push(scope.conf.currentPage);for(var i=1;i<=offset/2;i++)scope.pageList.push(scope.conf.currentPage+i);scope.pageList.push("..."),scope.pageList.push(scope.conf.numberOfPages)}}scope.conf.onClick&&(oldValue!=newValve&&0==oldValue[0]||scope.conf.onClick(scope.conf)),scope.conf.target?scope.conf.target.currentPage=scope.conf.currentPage:scope.$parent.SearchPOJO?scope.$parent.SearchPOJO.currentPage=scope.conf.currentPage:scope.conf.methodFn&&scope.conf.methodFn(scope.conf)}scope.changeCurrentPage=function(item){"..."!=item&&(scope.conf.currentPage=item,$(window).scrollTop(0))},scope.prevPage=function(){scope.conf.currentPage>1&&(scope.conf.currentPage-=1)},scope.nextPage=function(){scope.conf.currentPage<scope.conf.numberOfPages&&(scope.conf.currentPage+=1)},scope.checkInput=function(){scope.jumpPageNum=scope.jumpPageNum.replace(/[^0-9]/g,"")},scope.jumpToPage=function(e){var keycode=window.event?e.keyCode:e.which;13==keycode&&""!==scope.jumpPageNum&&(scope.conf.currentPage=scope.jumpPageNum)},scope.$watch(function(){return scope.conf.totalItems+" "+scope.conf.currentPage+" "+scope.conf.pageSize},getPagination)}}}]),knowledge_static_web.directive("onRenderFinish",[function(){return{restrict:"A",link:function(scope,element,attrs,controller){scope.$last===!0&&scope.$emit("onRenderFinish")}}}]),knowledge_static_web.directive("alertBar",[function(){return{restrict:"EA",templateUrl:"know_index/base/tip/directives/tip.html",scope:{message:"=",type:"="},link:function(scope,element,attrs){scope.hideAlert=function(){scope.message=null,scope.type=null}}}}]),knowledge_static_web.factory("TipService",["$timeout",function($timeout){var tipService={message:null,type:null,setMessage:function(msg,type){this.message=msg,this.type=type;var _self=this;$timeout(function(){_self.clear()},3e3)},clear:function(){this.message=null,this.type=null}};return tipService}]),knowledge_static_web.controller("knowItemDeleteController",["$scope","KnowledgeManagementService","TipService","KnowledgePortalService",function($scope,KnowledgeManagementService,TipService,KnowledgePortalService){$scope.knowItemDelete=function(){var knowItemId=$scope.ngDialogData.selectedKnowItem.id;return null==knowItemId||""==knowItemId?void TipService.setMessage("知识条目ID不能为空","warning "):void KnowledgePortalService.deleteKnowItem(knowItemId)}}]),knowledge_static_web.controller("knowItemShareController",["$scope","KnowledgeManagementService","TipService","KnowledgePortalService",function($scope,KnowledgeManagementService,TipService,KnowledgePortalService){KnowledgeManagementService.get({},function(result){200==result.status&&result.data.list.length>0&&($scope.knowLibraries=result.data.list)}),$scope.knowItemShare=function(){var knowItemId=$scope.ngDialogData.selectedKnowItem.id;return null==$scope.selectedKnowLibrary||""==$scope.selectedKnowLibrary?void TipService.setMessage("请选定知识库","warning "):null==knowItemId&&""==$knowItemId?void TipService.setMessage("请选定知识条目","warning "):void KnowledgePortalService.share(knowItemId,$scope.selectedKnowLibrary)}}]),angular.module("homePage").controller("homePageNavController",["$scope","$location","localStorageService","AuthService",function($scope,$location,localStorageService,AuthService){}]),angular.module("homePage").controller("homePageController",["$scope","$location","localStorageService","AuthService","$state",function($scope,$location,localStorageService,AuthService,$state){$state.go("homePage.define")}]),angular.module("indexModule").controller("indexController",["$scope","$location","$interval","$timeout","$state","IndexService","AuthService","PersonalCenterService",function($scope,$location,$interval,$timeout,$state,IndexService,AuthService,PersonalCenterService){$scope.active=function(path){var url=$location.absUrl();return new RegExp(path).test(url)?"active":""},$scope.logout=function(){AuthService.logout(function(data){},function(errMsg){$scope.errMsg=errMsg})},AuthService.checkLoginStatus({},function(data){$scope.setCurrentUser(data)});var permissionList=[];AuthService.checkLoginStatus({},function(data){$scope.setCurrentUser(data),permissionList=data.privileges}),$scope.toBack=function(){return permissionList.indexOf("back.gateway")!=-1?void $state.go("back.gateway"):permissionList.indexOf("back.task")!=-1?void $state.go("back.task"):permissionList.indexOf("back.manageBase")!=-1?void $state.go("back.manageBase"):permissionList.indexOf("back.application")!=-1?void $state.go("back.application"):permissionList.indexOf("back.system")!=-1?void $state.go("back.system"):void 0}}]),angular.module("knowledgeManagementModule").controller("NewFactorKnowController",["$scope","localStorageService","$state","ngDialog",function($scope,localStorageService,$state,ngDialog){$scope.vm={fagAdd:factorAdd}}]),angular.module("knowledgeManagementModule").controller("knowManaListController",["$scope","localStorageService","$state","ngDialog",function($scope,localStorageService,$state,ngDialog){function listAdd(){ngDialog.openConfirm({template:"/know_index/knowledgeManagement/knowledgeManagementFaqDialog.html",scope:$scope,closeByDocument:!1,closeByEscape:!0,showClose:!0,backdrop:"static",preCloseCallback:function(e){}})}$scope.vm={fagAdd:listAdd}}]),angular.module("knowledgeManagementModule").controller("knowledgeEssentialController",["$scope","localStorageService","$state","ngDialog",function($scope,localStorageService,$state,ngDialog){function knowledgeBot(ev,lev){var ele=ev.target;0==lev?$(ele).next().slideToggle():$(ele).css({backgroundPosition:"left bottom"}).parent().parent().next().slideToggle()}function botValChange(val,id){$scope.vm.knowledgeBotVal=val}function KnowledgeAdd(){ngDialog.openConfirm({template:"/know_index/knowledgeManagement/essential/essentialDialog.html",scope:$scope,closeByDocument:!1,closeByEscape:!0,showClose:!0,backdrop:"static",preCloseCallback:function(e){}})}function getChannel(){httpRequestPost("/api/elementKnowledgeAdd/loadChannel",{applicationId:"360619411498860544"},function(data){$scope.vm.channels=data.data,$scope.$apply()},function(err){})}$scope.vm={aa:{list:["s","a","z"]},KnowledgeAdd:KnowledgeAdd,knowledgeBot:knowledgeBot,knowledgeBotVal:"",botValChange:botValChange,knowledgeTitle:"",timeStart:"",timeEnd:"",isTimeTable:!1,timeFlag:"启用",titleGroup:"",channels:"",a:function(){alert("ddddd")}},$scope.$watch("vm.isTimeTable",function(val){1==val?$scope.vm.timeFlag="禁用":$scope.vm.timeFlag="启用"}),getChannel()}]),angular.module("knowledgeManagementModule").controller("knowledgeManagementController",["$scope","localStorageService","$state",function($scope,localStorageService,$state){$scope.vm={userName:"",password:""}}]),angular.module("knowledgeManagementModule").controller("knowledgeSingleAddConceptController",["$scope","localStorageService","$state","ngDialog",function($scope,localStorageService,$state,ngDialog){function knowledgeBot(ev,lev){var ele=ev.target;0==lev?$(ele).next().slideToggle():$(ele).css({backgroundPosition:"left bottom"}).parent().parent().next().slideToggle()}function botValChange(val,id){$scope.vm.knowledgeBotVal=val}function KnowledgeAdd(){ngDialog.openConfirm({template:"/know_index/knowledgeManagement/concept/knowledgeAddSingleConceptDialog.html",scope:$scope,closeByDocument:!1,closeByEscape:!0,showClose:!0,backdrop:"static",preCloseCallback:function(e){}})}$scope.vm={aa:{list:["s","a","z"]},KnowledgeAdd:KnowledgeAdd,knowledgeBot:knowledgeBot,knowledgeBotVal:"",botValChange:botValChange,knowledgeTitle:"",timeStart:"",timeEnd:"",isTimeTable:!1,timeFlag:"启用",titleGroup:""},$scope.$watch("vm.isTimeTable",function(val){1==val?$scope.vm.timeFlag="禁用":$scope.vm.timeFlag="启用"})}]),knowledge_static_web.directive("loginInput",function(){return{restrict:"AE",link:function(scope,elem,attrs){elem.on("focus",function(e){$(this).parents(".login-fItem").addClass("focus")}).on("blur",function(){$(this).parents(".login-fItem").removeClass("focus")})}}}),angular.module("knowDetailsModule").controller("knowCompareController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","$stateParams","$state","$sce","DetailService","HomeService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,$stateParams,$state,$sce,DetailService,HomeService){var self=this;$scope.knowItemIds=$stateParams.knowItemIds,self.queryCompareKnowItem=function(){DetailService.queryCompareKnowItem.get({knowItemIds:$scope.knowItemIds},function(resource){if(200==resource.status&&200==resource.data.status&&2==resource.data.data.totalCount){$scope.knowItem1=resource.data.data.knowledgeList[0],$scope.knowItem2=resource.data.data.knowledgeList[1];var result=eq({value1:$scope.knowItem1.content,value2:$scope.knowItem2.content});$scope.content1=$sce.trustAsHtml(result.value1+"\r\n"),$scope.content2=$sce.trustAsHtml(result.value2+"\r\n")}},function(){})},self.queryCompareKnowItem()}]),angular.module("knowDetailsModule").controller("knowDetailsController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","$stateParams","DetailService","HomeService","$sce","TipService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,$stateParams,DetailService,HomeService,$sce,TipService){var self=this;$scope.knowItemId=$stateParams.knowItemId,$scope.queryKey=$stateParams.queryKey,self.initSearch=function(){$scope.SearchPOJO||($scope.SearchPOJO=$scope.initSearchPOJO()),$scope.SearchPOJO.pageSize=3,$scope.SearchPOJO.queryPage=!0,$scope.SearchPOJO.knowItemId=$stateParams.knowItemId,$scope.paginationConf={currentPage:$scope.SearchPOJO.currentPage,totalItems:0,pageSize:$scope.SearchPOJO.pageSize,pagesLength:6},$scope.paginationConf1={currentPage:$scope.SearchPOJO.currentPage,totalItems:0,pageSize:$scope.SearchPOJO.pageSize,pagesLength:6}},$scope.checkText=function(type,index){1==type?$scope.comment.length>500&&($scope.comment=$scope.comment.substr(0,500)):2==type&&$scope.require[index].length>500&&($scope.require[index]=$scope.require[index].substr(0,500))},self.getKnowItemById=function(){DetailService.getKnowledgeDetail.get({id:$scope.knowItemId,queryKey:$scope.queryKey},function(resource){if(200==resource.status){$scope.knowItem=resource.data;var know=$scope.knowItem,title=$sce.trustAsHtml(know.title),content=$sce.trustAsHtml(know.content);know.titleHtml=title,know.contentHtml=content}})},self.queryLinkKnowItems=function(){DetailService.queryLinkKnowItems.get({id:$scope.knowItemId},function(resource){200==resource.status&&($scope.linkKnowItems=resource.data)})},self.queryCommentByKnowItem=function(){DetailService.queryCommentByKnowItem.get({knowItemId:$scope.SearchPOJO.knowItemId,pageNo:$scope.SearchPOJO.currentPage,pageSize:$scope.SearchPOJO.pageSize,queryPage:$scope.SearchPOJO.queryPage},function(resource){200==resource.status&&200==resource.data.status&&($scope.comments=resource.data.data.data,$scope.paginationConf.totalItems=resource.data.data.total)})},$scope.queryRequireByComment=function(userId){DetailService.queryRequireByComment.get({type:1,userId:userId,knowItemId:$scope.SearchPOJO.knowItemId,queryPage:$scope.SearchPOJO.queryPage},function(resource){200==resource.status&&200==resource.data.status&&($scope.requires=resource.data.data.data)})},$scope.require=[],$scope.addAnswer=function(knowItemId,targetId,index){var require=$scope.require[index],flag=!1;return null==require?void alert("回复不能为空！"):(null!=require&&(flag=!0),void(flag&&HomeService.createComment.save({content:require,knowItemId:knowItemId,targetId:targetId,type:1},function(resource){200==resource.status?($scope.result=resource.data,$scope.result?TipService.setMessage("回复成功!","success"):TipService.setMessage("回复失败!","error")):TipService.setMessage("回复失败!","error"),$scope.SearchPOJO.currentPage=1,self.queryCommentByKnowItem()})))},$scope.addComment=function(){var comment=$scope.comment,flag=!1;return null==comment||""==comment?void alert("评论不能为空！"):(null!=comment&&(flag=!0),void(flag&&HomeService.createComment.save({content:comment,knowItemId:$scope.knowItemId,type:0,targetId:$scope.knowItem.userId},function(resource){200==resource.status?($scope.comment="",TipService.setMessage("评论成功!","success")):TipService.setMessage("评论失败!","error"),$scope.SearchPOJO.currentPage=1,self.queryCommentByKnowItem()})))},$scope.cancelComment=function(){$scope.comment=""},$scope.likeKnowItem=function(status,knowItemId,libraryId,libName){status?status&&HomeService.agree.save({knowId:knowItemId,optType:3,libraryId:libraryId,libraryName:libName},function(resource){200==resource.status&&TipService.setMessage("取消点赞成功!","success"),self.getKnowItemById()}):HomeService.agree.save({knowId:knowItemId,optType:3,libraryId:libraryId,libraryName:libName},function(resource){200==resource.status&&TipService.setMessage("点赞成功!","success"),self.getKnowItemById()})},$scope.collectKnowItem=function(status,knowItemId,libraryId,libName){status?status&&HomeService.collect.save({knowId:knowItemId,optType:4,libraryId:libraryId,libraryName:libName},function(resource){200==resource.status&&TipService.setMessage("取消收藏成功!","success"),self.getKnowItemById()}):HomeService.collect.save({knowId:knowItemId,optType:4,libraryId:libraryId,libraryName:libName},function(resource){200==resource.status&&TipService.setMessage("收藏成功!","success"),self.getKnowItemById()})},$scope.canAgree=function(agreeStatus){return agreeStatus?"icon icoimg dz_s":"icon icoimg dz"},$scope.canCollect=function(collectStatus){return collectStatus?"icon icoimg sc_s":"icon icoimg sc"},$scope.deleteComment=function(commentId){DetailService.deleteComment.save({commentId:commentId},function(resource){200==resource.status?(TipService.setMessage("操作成功!","success"),self.queryCommentByKnowItem()):TipService.setMessage("操作失败!","error")})},self.initSearch(),self.getKnowItemById(),$scope.$watch("SearchPOJO",self.queryCommentByKnowItem,!0)}]),angular.module("knowDetailsModule").controller("knowDocController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","$stateParams","$state","$sce","KnowDocService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,$stateParams,$state,$sce,KnowDocService){var self=this;$scope.knowDocId=$stateParams.knowDocId,self.getKnowDocInfo=function(){KnowDocService.queryDetailByDocId.save({documentationId:$scope.knowDocId},function(resource){200==resource.status&&($scope.knowDoc=resource.data)},function(){})},self.getKnowDocInfo()}]),angular.module("knowDetailsModule").controller("knowEditController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","$stateParams","$state","$sce","DetailService","TipService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,$stateParams,$state,$sce,DetailService,TipService){var self=this;$scope.knowItemId=$stateParams.knowItemId,$scope.processInstanceId=$stateParams.processInstanceId,$scope.editFlg=!1,$scope.pIdFlg=!1,self.queryKnowItem=function(){DetailService.queryKnowItem.get({id:$scope.knowItemId},function(resource){if(200==resource.status){$scope.knowItem=resource.data;var know=$scope.knowItem,content=$sce.trustAsHtml(know.content);$scope.knowItem.contentHtml=content}})},self.getProcessInstanceId=function(){DetailService.getProcessInstanceId.get({businessKey:$scope.knowItemId},function(resource){200==resource.status&&null==resource.data&&($scope.pIdFlg=!0)})},self.queryKnowItem(),null==$scope.processInstanceId?self.getProcessInstanceId():$scope.pIdFlg=!1,$scope.updateKnowItem=function(){DetailService.updateKnowItem.save({knowid:$scope.knowItemId,title:$scope.knowItem.title,content:$scope.knowItem.content},function(resource){200==resource.status?(TipService.setMessage("操作成功!","success"),$scope.editFlg=!0):TipService.setMessage("操作失败!","error")})},$scope.startWorkflow=function(){DetailService.startWorkflow.save({knowItemId:$scope.knowItemId},function(resource){200==resource.status?TipService.setMessage("流程已发起!","success"):TipService.setMessage("操作失败!","error")})},$scope.content="这是测试的编辑内容",$scope.ready=function(editor){alert(editor.getContent())}}]),angular.module("knowDetailsModule").controller("knowVersionController",["$scope","$location","$routeParams","$interval","$timeout","ngDialog","$stateParams","$state","DetailService","HomeService",function($scope,$location,$routeParams,$interval,$timeout,ngDialog,$stateParams,$state,DetailService,HomeService){var self=this;$scope.compareKnowItemIds=[],$scope.knowItemId=$stateParams.knowItemId,self.queryVersionByIdentity=function(){DetailService.queryVersionByIdentity.get({knowItemId:$scope.knowItemId},function(resource){200==resource.status&&200==resource.data.status&&($scope.knowItemList=resource.data.data.knowledgeList)},function(){})},$scope.toCompare=function(knowItemId){$.inArray(knowItemId,$scope.compareKnowItemIds)==-1?$scope.compareKnowItemIds.push(knowItemId):$scope.compareKnowItemIds.splice(jQuery.inArray(knowItemId,$scope.compareKnowItemIds),1)},$scope.exitCompare=function(){2==$scope.compareKnowItemIds.length?$state.go("index.version_compare",{knowItemIds:$scope.compareKnowItemIds}):alert("请选择两个需要比较的知识条目")},self.queryVersionByIdentity()}]),angular.module("knowDetailsModule").controller("knowViewController",["$scope","$location","$anchorScroll","$interval","$timeout","ngDialog","$stateParams","$state","DetailService","$sce","KnowDocService",function($scope,$location,$anchorScroll,$interval,$timeout,ngDialog,$stateParams,$state,DetailService,$sce,KnowDocService){var self=this;$scope.knowDocId=$stateParams.knowDocId,self.queryKnowItemsByDocId=function(){DetailService.queryKnowItemsByDocId.save({documentationId:$scope.knowDocId},function(resource){200==resource.status&&200==resource.data.status&&($scope.docItems=resource.data.objs,$scope.docItems.forEach(function(know){var titleHtml=$sce.trustAsHtml(know.title),contentHtml=$sce.trustAsHtml(know.content);know.titleHtml=titleHtml,know.contentHtml=contentHtml}))},function(){})},$scope.checkShow=function(){var url=$location.url();return!(!url.toString().indexOf("/index/")>0)},self.queryKnowItemsByDocId(),$scope.jumper=function(key){$location.hash(key),$anchorScroll()}}]).directive("contentMore",function(){return{restrict:"AE",link:function(scope,elem,attrs){elem.on("click",function(e){e.stopPropagation(),$(this).parent().siblings(".dd").css("max-height","inherit").siblings(".dn").show(),$(this).hide().siblings(".less").show()})}}}).directive("contentLess",function(){return{restrict:"AE",link:function(scope,elem,attrs){elem.on("click",function(e){e.stopPropagation(),$(this).parent().siblings(".dd").css("max-height","130px").siblings(".dn").hide(),$(this).hide().siblings(".edit_more").show()})}}}),angular.module("knowDetailsModule").directive("answer",function(){return{restrict:"AE",link:function(scope,elem,attrs){elem.on("click",function(e){e.stopPropagation(),$(this).parents("li").addClass("bg").find(".act-comment").show()})}}}),angular.module("knowDetailsModule").directive("cancelAnswer",function(){return{restrict:"AE",link:function(scope,elem,attrs){elem.on("click",function(e){$(this).parents(".act-comment").hide(),$(this).parents("li").removeClass("bg")})}}}),knowledge_static_web.directive("docView",function(RecursionHelper,PortalService){return{restrict:"E",replace:!0,template:'<div id="swfMain" style="height:600px;"></div>',link:function(scope,elem,attrs){$("#swfMain").FlexPaperViewer({config:{SwfFile:escape("/back/knowaccess/docimport/docmanager/viewKnowDoc/"+scope.knowDocId),
jsDirectory:"swf/print/FlexPaperViewer",Scale:.6,ZoomTransition:"easeOut",key:"@1bb10db124f45f30fb1$a98113c5cbb8921df84",ZoomTime:.5,ZoomInterval:.2,FitPageOnLoad:!1,FitWidthOnLoad:!0,FullScreenAsMaxWindow:!1,ProgressiveLoading:!1,MinZoomSize:.2,MaxZoomSize:5,SearchMatchAll:!1,InitViewMode:"Portrait",PrintPaperAsBitmap:!1,RenderingOrder:"flash",StartAtPage:"",ViewModeToolsVisible:!0,ZoomToolsVisible:!0,NavToolsVisible:!0,CursorToolsVisible:!0,SearchToolsVisible:!0,localeChain:"zh_CN"}})}}}),knowledge_static_web.directive("versionCompareRow",function(){return{restrict:"A",scope:{},link:function($scope,elem,attrs){elem.on("click",function(e){$(this).parents("tr").hasClass("on")?$(this).parents("tr").removeClass("on"):$(this).parents("tr").addClass("on")})}}}),knowledge_static_web.directive("versionCompareCombo",function(){return{restrict:"A",scope:{},link:function($scope,elem,attrs){var evTimeStamp=0;elem.click(function(e){var now=+new Date;now-evTimeStamp<100||(evTimeStamp=now,1==$(this).hasClass("my-checkbox-on")?$(this).removeClass("my-checkbox-on"):$(this).addClass("my-checkbox-on"))})}}}),knowledge_static_web.directive("versionCompareRow",function(){return{restrict:"E",scope:{},link:function($scope,elem,attrs){elem.on("click",function(e){$(this).parents("tr").hasClass("on")?$(this).parents("tr").removeClass("on"):$(this).parents("tr").addClass("on")})}}}),angular.module("loginModule").controller("loginController",["$scope","$location","localStorageService","$state",function($scope,$location,localStorageService,$state){function keyLogin($event){13==$event.keyCode&&login()}function randomNumberChange(){$scope.vm.randomNumber=randomNumber(4)}function login(){0==$scope.vm.randomNumberValue.length?alert("验证码不能为空"):$scope.vm.randomNumberValue!=$scope.vm.randomNumber?alert("验证码错误"):httpRequestPost("/api/user/userLogin",{userName:$scope.vm.userName,userPassword:$scope.vm.password},function(data){setCookie("userName",$scope.vm.userName),setCookie("userId",data.data.userId),$state.go("admin",{userPermission:data.data.roleList})},function(err){})}function randomNumber(number){for(var rnd="",i=0;i<number;i++)rnd+=Math.floor(10*Math.random());return rnd}$scope.vm={userName:"",password:"",randomNumber:randomNumber(4),randomNumberValue:"",randomNumberChange:randomNumberChange,login:login,keyLogin:keyLogin}}]),angular.module("materialManagement").controller("chatKnowledgeBaseController",["$scope","$state",function($scope,$state){alert(),$state.go("materialManagement.chatKnowledgeBase"),$scope.vm={}}]),angular.module("myApplicationModule").controller("addAdminController",["$scope","$state","$stateParams",function($scope,$state,$stateParams){$state.go("admin.manage",{userPermission:$stateParams.userPermission})}]),angular.module("myApplicationModule").controller("adminContentController",["$scope","$state","$timeout","$stateParams","ngDialog",function($scope,$state,$timeout,$stateParams,ngDialog){function myApplication(){var sel=$scope;httpRequestPost("/api/application/application/listApplicationByUserId",{userId:getCookie("userId")},function(data){sel.vm.myApplication=data.data,$scope.$apply()},function(err){})}function selectLicence(){httpRequestPost("/api/application/scene/listAllScene",{},function(data){return $scope.vm.selectLicence=data.data,$scope.$apply(),data.data},function(err){})}function addApplicationWindow(){ngDialog.openConfirm({template:"/know_index/admin/addAdmin.html",scope:$scope,closeByDocument:!1,closeByEscape:!0,showClose:!0,backdrop:"static",preCloseCallback:function(e){1===e&&addApplication()}})}function addApplication(){httpRequestPost("/api/application/application/addApplication",{userId:getCookie("userId"),applicationName:$scope.vm.newApplicationName,sceneId:$scope.vm.newScene,applicationLisence:$scope.vm.newLicence,applicationDescription:$scope.vm.newDescribe},function(data){},function(err){})}setCookie("userName","mf"),getCookie("userName"),$scope.vm={userName:getCookie("userName"),userPermission:$stateParams.userPermission,addApplicationWindow:addApplicationWindow,myApplication:"",selectLicence:"",newApplicationName:"",newScene:"",newLicence:"",newDescribe:""},myApplication(),selectLicence()}]),angular.module("myApplicationModule").controller("myApplicationController",["$scope","$state","$stateParams",function($scope,$state,$stateParams){$state.go("myApplication.manage",{userPermission:$stateParams.userPermission})}]),angular.module("myApplicationSettingModule").controller("myApplicationSettingController",["$scope","$state","$stateParams",function($scope,$state,$stateParams){function isSlide(event){var self=event.target;$(self).hasClass("slideActive")?$(self).removeClass("slideActive").next(".menu_1").stop().slideToggle():$(self).addClass("slideActive").next(".menu_1").stop().slideToggle()}$scope.vm={isSlide:isSlide}}]);